<!DOCTYPE html>
<html>
<head>
  <title>üí• Tap & Blast</title>
  <style>
    body { font-family: Arial; background: #fffef6; padding: 20px; text-align: center; }
    #blastBtn { width: 150px; height: 150px; background: red; color: white; font-size: 20px; border-radius: 50%; border: none; margin: 20px; cursor: pointer; }
    button, input { padding: 10px; font-size: 16px; border-radius: 8px; margin: 10px; border: none; }
    #result { font-size: 20px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>üí• Tap & Blast</h2>
  <p>Stake (Min ‚Ç¶100):</p>
  <input type="number" id="stake" /><br>
  <button onclick="startGame()">Start</button>

  <div id="gameArea" style="display:none;">
    <p>Tap the red button when it changes to üí•!</p>
    <button id="blastBtn" onclick="tap()">Wait</button>
  </div>

  <h3 id="result"></h3>
  <p><a href="dashboard.html">‚¨Ö Back to Dashboard</a></p>

<script>
let canTap = false, stake = 0;

function getBalance() {
  return parseFloat(localStorage.getItem("balance") || "20000");
}
function setBalance(val) {
  localStorage.setItem("balance", val.toFixed(3));
}
function saveToHistory(msg) {
  let logs = JSON.parse(localStorage.getItem("history") || "[]");
  logs.unshift({ text: msg, time: new Date().toLocaleString() });
  localStorage.setItem("history", JSON.stringify(logs));
}

function startGame() {
  stake = parseFloat(document.getElementById("stake").value);
  if (isNaN(stake) || stake < 100) return alert("Stake must be ‚Ç¶100+");
  if (stake > getBalance()) return alert("Insufficient balance");

  setBalance(getBalance() - stake);
  document.getElementById("result").textContent = "";
  document.getElementById("gameArea").style.display = "block";
  document.getElementById("blastBtn").textContent = "Wait";
  canTap = false;

  const delay = Math.floor(Math.random() * 4000) + 2000;

  setTimeout(() => {
    canTap = true;
    document.getElementById("blastBtn").textContent = "üí•";
  }, delay);
}

function tap() {
  if (!canTap) {
    document.getElementById("result").textContent = "üòì Too early! You lost ‚Ç¶" + stake.toFixed(2);
    saveToHistory(`‚ùå Tap & Blast Loss: ‚Ç¶${stake}`);
    document.getElementById("gameArea").style.display = "none";
  } else {
    let win = stake * 2;
    setBalance(getBalance() + win);
    document.getElementById("result").textContent = "üéâ Boom! You won ‚Ç¶" + win.toFixed(2);
    saveToHistory(`‚úÖ Tap & Blast Win: ‚Ç¶${win.toFixed(2)} from ‚Ç¶${stake}`);
    document.getElementById("gameArea").style.display = "none";
  }
}
</script>
</body>
</html>