<!DOCTYPE html>
<html>
<head>
  <title>Spin & Win</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #e0f7f1;
      text-align: center;
      padding: 30px;
    }
    h2 { color: #00b96b; }
    .wheel {
      margin: 20px auto;
      width: 250px;
      height: 250px;
      border: 10px solid #00b96b;
      border-radius: 50%;
      position: relative;
      animation: rotate 5s ease-out;
    }
    .arrow {
      width: 0; height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 30px solid red;
      margin: 0 auto;
    }
    input, button {
      padding: 10px;
      margin: 10px;
      font-size: 16px;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(1440deg); }
    }
  </style>
</head>
<body>

<h2>üéØ Spin & Win</h2>
<p>Stake Amount (‚Ç¶):</p>
<input type="number" id="stake" placeholder="Min 100" /><br>
<button onclick="spin()">Spin Now üé°</button>

<div class="arrow"></div>
<div class="wheel" id="wheel" style="background: conic-gradient(#00b96b 0% 50%, #f44336 50% 100%);"></div>

<h3 id="result"></h3>
<p><a href="dashboard.html">‚¨Ö Back to Dashboard</a></p>

<script>
function getBalance() {
  return parseFloat(localStorage.getItem("balance") || "20000");
}

function setBalance(amount) {
  localStorage.setItem("balance", amount.toFixed(3));
}

function saveToHistory(msg) {
  let logs = JSON.parse(localStorage.getItem("history") || "[]");
  logs.unshift({ text: msg, time: new Date().toLocaleString() });
  localStorage.setItem("history", JSON.stringify(logs));
}

function spin() {
  let stake = parseFloat(document.getElementById("stake").value);
  let balance = getBalance();
  if (isNaN(stake) || stake < 100) {
    alert("Minimum stake is ‚Ç¶100");
    return;
  }
  if (stake > balance) {
    alert("Insufficient balance");
    return;
  }

  // Deduct stake first
  balance -= stake;
  setBalance(balance);

  let outcome = Math.random() < 0.5 ? 'lose' : 'win'; // 50/50 chance

  let wheel = document.getElementById("wheel");
  wheel.style.animation = "spin 3s ease-out";

  setTimeout(() => {
    if (outcome === "win") {
      let winAmount = stake * 2;
      balance += winAmount;
      setBalance(balance);
      document.getElementById("result").textContent = `üéâ You WON ‚Ç¶${winAmount.toFixed(2)}!`;
      saveToHistory(`‚úÖ Spin Win: ‚Ç¶${winAmount.toFixed(2)} (Stake: ‚Ç¶${stake})`);
    } else {
      document.getElementById("result").textContent = `üò¢ You lost ‚Ç¶${stake.toFixed(2)}`;
      saveToHistory(`‚ùå Spin Loss: ‚Ç¶${stake.toFixed(2)} deducted`);
    }
  }, 3000);
}
</script>

</body>
</html>